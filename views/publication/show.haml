%h1 #{@code.titre}

- if session["username"]
  - if !@is_favorite
    %a{:href=> "#{request.path}/fav",:class=>"fav"} &hearts; Mettre dans mes favoris
  - else
    %a{:href=> "#{request.path}/fav", :class=>"unfav"} &hearts; Enlever dans mes favoris


%div.info
  par
  %a{:href=>"/user/#{@user.username}"} #{@user.username}
  %span{:class=>"time"} Créé: #{distance_of_time_in_words(@code.created_at)}

  - if @code.created_at!=@code.updated_at
    %span{:class=>"time"} Modfié: #{distance_of_time_in_words(@code.updated_at)}

  %a{:href=>"/type/#{@code.type}", :class=>"type"}#{@code.type}

  %div.stat
    %div
      Vues:#{@code.views}
    %div
      Commentaires:#{@comments.length}
    %div
      Favoris:#{@code.count_favorite}

%div.desc
  Description:#{@code.desc}


- if session["id"]==@code.user_id
  %form{:action=>"/#{@code.id}/destroy_it", :method=>"post"}
    %input{:type=>"hidden", :name=>"_method", :value=>"delete"}
    %input{:type=>"submit", :value=>"Supprimer"}

- if session["id"]==@code.user_id
  %a{:href=>"/#{@code.id}/modify"} Modifier

- if @code.type!="image"
  %pre{:class=>"brush: #{@code.type}"}
    :preserve
    ~ @code.body
- else
  %img{:src=>"files/#{@code.id}"}



%div#commentaires
- @comments.each do |comment|
  %div.commentaire
    %h4<
      =comment.nom
      %span= " | "+distance_of_time_in_words(comment.created_at)
    %p=comment.body


- if session["username"]

  %h3
    Écrire un commentaire:
  %form{:action=>"/#{@code.id}", :method=>"post"}
    %p 
      %textarea{:name=>"comment_body"}
      %input{:type=>"submit"}

- if @code.type!="image"
  %link(href="css/shCoreDefault.css" rel="stylesheet" type="text/css")
  %script(src="js/shCore.js" type="text/javascript")
  %script(src="js/shAutoloader.js" type="text/javascript")
  %script(type="text/javascript")

    SyntaxHighlighter.autoloader(
    'applescript            js/shBrushAppleScript.js',
    'actionscript3 as3      js/shBrushAS3.js',
    'bash shell             js/shBrushBash.js',
    'cpp c                  js/shBrushCpp.js',
    'c# c-sharp csharp      js/shBrushCSharp.js',
    'css                    js/shBrushCss.js',
    'java                   js/shBrushJava.js',
    'jfx javafx             js/shBrushJavaFX.js',
    'js jscript javascript  js/shBrushJScript.js',
    'perl pl                js/shBrushPerl.js',
    'php                    js/shBrushPhp.js',
    'text plain             js/shBrushPlain.js',
    'py python              js/shBrushPython.js',
    'ruby rails ror rb      js/shBrushRuby.js',
    'sass scss              js/shBrushSass.js',
    'sql                    js/shBrushSql.js',
    'vb vbnet               js/shBrushVb.js',
    'xml xhtml xslt html    js/shBrushXml.js'

    );

    SyntaxHighlighter.all();


